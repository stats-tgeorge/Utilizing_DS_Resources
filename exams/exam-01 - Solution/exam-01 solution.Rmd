---
title: "Exam 1 DSC 223 Fall 2021 Block 1"
author: "Exam Solution"
date: "Due: 12/3/2021 at 11:59 PM"
output: 
  html_document: 
    fig_height: 4
    fig_width: 7
---

```{r setup, include = FALSE}
# set the echo option to FALSE to see how the document looks with the code suppressed
knitr::opts_chunk$set(echo = TRUE)
```

## Academic Honesty Statement

I, Tyler George, hereby state that I have not communicated with or gained information in any way from my classmates or anyone other than the Professor or TA during this exam, and that all work is my own.

## Load data
Complete the function to read the data in from the data folder.

```{r data-load}
youtube <- read.csv('data/youtube.csv')
```


### Answer the following about the day, month, and year you were born in (number format). Change the **eval=F** to T. Do not change the **include**.
```{r sample-data,include = F, eval=T}
d <-23
m <-10
y <- 1950

set.seed(d+m+y)

# The data you should be using for the exam:
youtube1 <- youtube[sample.int(247,247,T),]
```

You should use this new YouTube data for the remainder of the exam. 

## Load packages

```{r load-packages, message=FALSE}
library(tidyverse)
library(ggridges)
```

## Questions 

### Question 1
```{r}
glimpse(youtube1)

youtube1 %>% select(funny)%>%
      ggplot(aes(x=funny))+
      geom_bar()
```

Looks like two thirds of the videos are funny. 

```{r}
youtube1 %>% select(patriotic)%>%
      ggplot(aes(x=patriotic))+
      geom_bar()
```

Very few of the videos are patriotic. Only around 30 out of the 247. 

```{r}
youtube1 %>% select(danger)%>%
      ggplot(aes(x=danger))+
      geom_bar()
```

Around 75 of the 247 videos contained danger. I would not have expected this. 

```{r}
youtube1 %>% select(like_count)%>%
      ggplot(aes(x=like_count))+
      geom_boxplot()+
      scale_x_continuous(limits = c(0,7500))
      
youtube1 %>% select(comment_count)%>%
      ggplot(aes(x=comment_count))+
      geom_boxplot()+
      scale_x_continuous(limits = c(0,2000))
      
youtube1 %>% select(dislike_count)%>%
      ggplot(aes(x=dislike_count))+
      geom_boxplot()+
      scale_x_continuous(limits = c(0,500))
```

All three boxplots of dislike counts, comment count, and like counts are heavily skewed right. We have zoomed in so we can see the distribution aside from just the outliers. 

### Question 2
```{r}
youtube1 %>% 
  ggplot(aes(x=like_count,y=dislike_count))+
  geom_point()

youtube1 %>% 
  ggplot(aes(x=funny,fill=danger))+
  geom_bar(position = "fill")

youtube1 %>% 
  ggplot(aes(x=like_count,colour=funny))+
  geom_boxplot()+
      scale_x_continuous(limits = c(0,7500))
  
```

Looking ath like count vs disklike count we see that thay are related with some extreme outliers. 

The barchart of funny and danger shows us that for videos without funny elements, around 15% of them contain danger but videos with funny are different, around 35% containing danger. 

Finally our zoomed in barchart of like count split by funny shows us that non funny videos have a much larger variability than funny videos in like counts. It also shows us, surprisingly, that non funny videos tend to be more reliably high in likes. 


### Question 3

```{r}
youtube1 %>% 
  filter(like_count <7500,dislike_count<500)%>%
  mutate(funny = case_when(
    funny == TRUE ~ "Funny",
    funny == FALSE ~ "Not Funny"),
    danger = case_when(
      danger == TRUE ~ "Danger Shown",
      danger == FALSE ~ "No Danger Shown")
    )%>%
  ggplot(aes(x=like_count,y=dislike_count,colour=funny))+
  geom_point()+
  facet_wrap(~danger)+
  labs(title = "Superbowl Ad Commercial Videos Likes vs Dislikes",
       subtitle = "Split by Video Components Danger and Funny",
       x= "Like Count",
       y = "Dislike Count",
       colour = "")

```

This plot allows us to compare dislikes vs likes between but broken down but by both whether the video has funny (or not) elements and if it contained danger. For visualizing extreme outliers are trimmed off. There does not seem to be any evidence that danger and funny are related. There is a very clear differnce for like counts and dislike counts based on whether the video has funny components (as seen before).  


### Question 4
This is partially done before. Lets look at just funny and like counts. 

```{r}
youtube1 %>% 
  filter(like_count <7500)%>%
  mutate(funny = case_when(
    funny == TRUE ~ "Funny",
    funny == FALSE ~ "Not Funny"))%>%
  ggplot(aes(y=like_count,fill=funny))+
  geom_boxplot()+
  labs(fill = "",
       title = "Like Count by Funny or Not",
       y = "Like Count")
```

### Question 5

```{r}
youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(funny==TRUE)%>%
  summarize(med_f_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(show_product_quickly==TRUE)%>%
  summarize(med_s_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(patriotic==TRUE)%>%
  summarize(med_p_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(celebrity==TRUE)%>%
  summarize(med_c_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(danger==TRUE)%>%
  summarize(med_d_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(animals==TRUE)%>%
  summarize(med_a_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = like_count/view_count) %>%
  filter(use_sex==TRUE)%>%
  summarize(med_u_ratio = median(ratio,na.rm=T))
```
 
Celebrity appears to have the highest median ratio of like counts to view counts at .0054 (still pretty low). 

This could be better solved with pivots. 

### Question 6

```{r}
youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(funny==TRUE)%>%
  summarize(med_f_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(show_product_quickly==TRUE)%>%
  summarize(med_s_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(patriotic==TRUE)%>%
  summarize(med_p_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(celebrity==TRUE)%>%
  summarize(med_c_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(danger==TRUE)%>%
  summarize(med_d_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(animals==TRUE)%>%
  summarize(med_a_ratio = median(ratio,na.rm=T))

youtube1 %>% mutate(ratio = dislike_count/view_count) %>%
  filter(use_sex==TRUE)%>%
  summarize(med_u_ratio = median(ratio,na.rm=T))
```

The lowest dislike count to view count is actually videos with sex portrayed in the video. This means that just because you get the most likes for each video does not mean you neccesariy get the least dislikes for each view. 

### Question 7
```{r}
youtube1 %>% count(funny,danger)
youtube1 %>% count(funny,show_product_quickly)
youtube1 %>% count(funny,patriotic )
youtube1 %>% count(funny,celebrity)
youtube1 %>% count(funny,animals)
youtube1 %>% count(funny,use_sex)

youtube1 %>% count(show_product_quickly,patriotic)
youtube1 %>% count(show_product_quickly,celebrity)
youtube1 %>% count(show_product_quickly,danger)
youtube1 %>% count(show_product_quickly,animals)
youtube1 %>% count(show_product_quickly,use_sex)

youtube1 %>% count(patriotic,celebrity)
youtube1 %>% count(patriotic,danger)
youtube1 %>% count(patriotic,animals)
youtube1 %>% count(patriotic,use_sex)

youtube1 %>% count(celebrity,danger)
youtube1 %>% count(celebrity,animals)
youtube1 %>% count(celebrity,use_sex)

youtube1 %>% count(danger,animals)
youtube1 %>% count(danger,use_sex)

youtube1 %>% count(animals,use_sex)

```

The most common combination is funny videos that show products quickly.

### Question 8

Eliminated from grading - extra credit given for work. 

### Question 9

We are going to look at the average likes per video with each component. 
```{r}
youtube_no_na <- youtube1 %>% 
          filter(!is.na(like_count),
          !is.na(funny),
          !is.na(show_product_quickly),
          !is.na(patriotic),
          !is.na(celebrity),
          !is.na(danger),
          !is.na(animals),
          !is.na(use_sex))

youtube_no_na %>% filter(funny == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(show_product_quickly == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(patriotic  == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(celebrity == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(danger == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(animals == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

youtube_no_na %>% filter(use_sex == TRUE)%>%
  summarize(like_per_video = sum(like_count)/n())

```

The average likes per video is patriotic at around 11,000. The next few are closer together but celebrity, show product quickly and funny in that order. Thus if you want a commercial that will get a lot of likes, make it patriotic, with a celebrity, something funny and show your add right away (according to this).

### Bonus

[Enter code and narrative here.]


